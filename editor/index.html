<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Map editor (dev nástroj)</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <header class="page-header">
    <div>
      <p class="eyebrow">/editor – offline tvůrce map</p>
      <h1>Vizuální tvůrce map pro tokeny jako <code>W1D3F5</code></h1>
      <p class="lede">
        Pomůcka pro ruční psaní map. Mění pouze lokální data – nezasahuje do hry ani do build pipeline.
        Ulož stránku do repa a otevři ji přes <code>/editor</code>. Výstup je vypsaný ve formátu, který se dá
        rovnou vložit do levelů s <code>layoutTokens</code> a <code>buildTileLayersFromTokens</code>.
      </p>
    </div>
    <div class="actions">
      <button type="button" class="button" data-fill-grid>Vyplnit mřížku vybraným tokenem</button>
      <button type="button" class="button secondary" data-reset-grid>Reset na čistou mapu</button>
    </div>
  </header>

  <main class="layout">
    <section class="panel">
      <h2>Rozměry mapy</h2>
      <div class="form-row">
        <label>
          Šířka (počet dlaždic)
          <input type="number" min="1" max="30" value="10" data-width-input>
        </label>
        <label>
          Výška (počet dlaždic)
          <input type="number" min="1" max="30" value="8" data-height-input>
        </label>
        <button type="button" class="button" data-apply-size>Nastavit rozměry</button>
      </div>

      <div class="form-row token-row">
        <div class="token-picker">
          <label for="token-input">Aktivní token</label>
          <input id="token-input" type="text" value="F1" data-token-input>
          <p class="hint">Klikni do mřížky: buňka dostane tento token.</p>
        </div>
        <div class="quick-tokens">
          <span class="label">Rychlé zkratky</span>
          <div class="token-buttons" data-quick-token-list>
            <button type="button" data-token="F1">F1 podlaha</button>
            <button type="button" data-token="F2">F2 podlaha</button>
            <button type="button" data-token="W1">W1 zeď</button>
            <button type="button" data-token="W2">W2 zeď</button>
            <button type="button" data-token="D1">D1 overlay</button>
            <button type="button" data-token="W1D1">W1D1 destrukce</button>
            <button type="button" data-token="W6D1F2">W6D1F2 odhalí F2</button>
            <button type="button" data-token="DOOR">DOOR zavřený</button>
            <button type="button" data-token="DOOR_OPEN">DOOR_OPEN</button>
            <button type="button" data-token="DECOR">DECOR konzole</button>
            <button type="button" data-token="FLOOR_BROKEN">FLOOR_BROKEN</button>
          </div>
        </div>
        <div class="texture-preview" data-texture-preview data-state="empty">
          <span class="label">Náhled textury</span>
          <div class="texture-preview-box">
            <div class="texture-placeholder">Vyber token z mřížky nebo zadej vlastní kód.</div>
            <img data-texture-image alt="" loading="lazy">
          </div>
          <p class="hint texture-status" data-texture-status>Čekám na zvolený token.</p>
        </div>
      </div>

      <div class="grid-wrapper">
        <div class="grid" data-grid aria-label="Interaktivní mřížka mapy"></div>
        <p class="hint">Tip: pravým klikem na buňku pipetuješ její token, levým přepíšeš aktivním tokenem.</p>
      </div>
    </section>

    <section class="panel output-panel">
      <header class="output-header">
        <div>
          <h2>Vygenerovaný výstup</h2>
          <p class="hint">Formát <code>layoutTokens</code> přesně jako v levelech. Výstup se průběžně aktualizuje.</p>
        </div>
        <button type="button" class="button" data-copy-output>Zkopírovat do schránky</button>
      </header>
      <pre class="output" data-output aria-live="polite"></pre>

      <section class="legend">
        <h3>Legenda tokenů</h3>
        <ul>
          <li><strong>F#</strong> – podlaha (např. <code>F1</code>, <code>F2</code>).</li>
          <li><strong>W#</strong> – zeď (např. <code>W1</code>, <code>W2</code>).</li>
          <li><strong>D#</strong> – overlay destrukce (např. <code>D1</code>, <code>D2</code>).</li>
          <li><strong>W#D#</strong> nebo <strong>F#D#</strong> – kombinace zdi/podlahy s destrukt overlayem (např. <code>W1D3</code>).</li>
          <li><strong>W#D#F#</strong> – zeď se zobrazením konkrétní podlahy po zničení (např. <code>W6D1F2</code>).</li>
          <li><strong>DOOR</strong>/<strong>DOOR_OPEN</strong> – dveře zavřené/otevřené.</li>
          <li><strong>DECOR</strong> – konzole/dekor.</li>
          <li><strong>FLOOR_BROKEN</strong> – rozbitá podlaha.</li>
        </ul>
        <p class="hint">Tokeny odpovídají parseru v <code>src/data/levels/map-utils.js</code>; lze zadat i vlastní text, pokud znáš další aliasy.</p>
      </section>
    </section>
  </main>

  <script type="module" src="./map-editor.js"></script>
</body>
</html>
